---
title: "Stellar DEX交易机器人"
date: 2021-03-03T21:20:08+08:00
lastmod: 2021-03-31T21:20:08+08:00
draft: false
tags: ["stellar", "xlm", "dex", "bot"]
categories: ["fun", "cryptocurrency"]
mathjax: false
---

本文主要讲述一个玩具性质的Stellar DEX交易机器人的实现思路。  
<!--more-->

# 背景
只是一个不开源、玩具性质、大概率亏钱的交易机器人实现思路:joy:。  
Stellar官方有一个免费、开源的 [Kelp](https://github.com/stellar/kelp) 做市机器人，有需要的可以自行收藏、使用。  

为什么选择Stellar DEX？  
- 自己控制资产  
  私钥自己保管，交易记录都在分布式账簿上(防篡改)。  
  中心化交易所(如币安)只是记录在数据库，跑路或者被黑客盗窃(已经发生过)将会血本无归。  
- 费用低  
  基本上不超过1分钱，与交易额无关。  
  中心化交易所都是千分之几的费率，与交易额正相关。  
- 速度快  
  秒级别的交易速度，比起比特币小时级别(6个确认)快多了。  
  不过还是比中心化交易所慢一些，毕竟后者只是更新内部数据库而已。  

Stellar DEX缺点：流动性不高，大部分时间都是机器人在操作(机器人间的PK:joy:)。  

# 参考文档
Stellar官方[说明文档](https://developers.stellar.org/docs)以及[API文档](https://developers.stellar.org/api)。
SDK在[这里](https://developers.stellar.org/docs/software-and-sdks)，其中Go SDK参考[Horizonclient](https://pkg.go.dev/github.com/stellar/go/clients/horizonclient)和[txnbuild](https://pkg.go.dev/github.com/stellar/go/txnbuild)。  

# 交易策略
简单来说就是定期调整+追跌杀涨的反套路交易策略。  
想法来源于香农投资手法，定期均衡资产(股票和现金)，在股价上涨时卖出、下跌时买入。  
听说香农投资手法由于交易费较贵在现实股市不太可行，还不如买指数基金。  
Stellar网络本身使用费用基本可以忽略不记，所以尝试使用该策略(变种)在DEX上面自动交易。  

-----
0310更新: 定期均衡本身不产生亏损或盈利，效果是涨和跌的幅度折半。  
不过均衡资产适合作为机器人持续运转的原点。  

# 实现
## 私钥安全
因为加密货币由私钥保管，所以代码和配置中不能明文保存。  
私钥经过加密、转换后分开几部分保存。  
另外可执行文件去掉调试信息和符号表。  

## 趋势判断
通过多个周期MA判断，有一定的滞后性。  

-----
0310更新: 目前没使用该指标。  

## 定期均衡
~~上升期降低加密货币占比，下降期提高加密货币占比，其余时候1:1分配。~~   
目前DEX流动性不足，恒定1:1。  

## 追跌杀涨
涨得多卖出，跌得多买入，提前根据收市价设置多级买单和卖单。  

-----
0310更新: 采用长周期MA偏离幅度和中周期MA回踩作为买卖点，适用性待观察。  

-----
0317更新：长周期MA偏离幅度作为介入点效果挺好。不过中周期MA回踩稍微有点滞后(也会更新)。  
改为基于介入点持仓成本达到一定幅度盈利再度介入(买入或卖出)。  

## 止损
0317更新：设置止损点，应对介入之后持续上升、持续下降情况。  

## 杂项
- 交易额控制  
  买单和卖单控制交易额，避免引起不必要的波动。  
- 总额限制  
  交易机器人帐号总额达到一定程度会转账部分盈利到硬件钱包(梦想还是要有的:moneybag:)。  
- 开机启动  
  7x24小时自动交易的工具人  

# 后记
这个交易机器人大概率是亏钱的，不过还是交由时间和币市来验证吧~  
后面不定期更新，看看实际效果。  
- [210303] 开始交易 `USDC/XLM`  
- [210310] 记录数据: 0.430269, 3221.942763, 1381.207066。追跌杀涨逻辑调整。  
- [210317] 记录数据: 0.393697, 3419.185749, 1346.608882。追跌杀涨逻辑微调。  
- [210324] 记录数据: 0.394846, 3487.346077, 1380.455513。  
- [210321] 记录数据: 0.393264, 3509.151102, 1380.022412。  

上周刚说完追跌杀涨还没打脸，第二天就暴跌13%触发了止损亏了2.5%。  
当然这种暴跌行情止损挺正常，谁知道会不会继续暴跌？  
后面又慢慢恢复，追跌杀涨成功了几次，今天看来基本维持上周的收益率。  

